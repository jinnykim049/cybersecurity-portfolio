## Here are some points to Remember.

# Main Componenets of Snort 
- Packet Decoder: collects and prepares the packets for pre-processing. 
- Pre-processors: arranges and modifies the packets for the detection engine.
- Detection Engine: The primary component. Dissect and analyse the packets by applying the rules. 
- Logging and Alerting: Log and alert generation component.
- Outputs and Plugins: Output integration modules (i.e. alerts to syslog/mysql) and additional plugin (rule management detection plugins) support is done with this component.  

# Three types of rules available for snort
1. Community Rules: Free ruleset under the GPLv2. Publicly accessible, no need for registration.
2. Registered Rules: Free ruleset (requires registration). This ruleset contains subscriber rules with 30 days delay. 
3. Subscriber Rules (Paid): Paid ruleset (requires subscription). This ruleset is the main ruleset and is updated twice a week (Tuesdays and Thursdays).
 
* More Rules: https://www.snort.org/downloads 

Note: Once Snort2 is installed, it automatically creates the required directories and files. However, to use the community or the paid rules, I need to indicate each rule in the snort.conf file.

# Remember, 
Since it is a long, all-in-one configuration file, editing it without causing misconfiguration is troublesome for some users. That is why Snort has several rule updating modules and integration tools. To sum up, the configured Snort configuration files should never be replaced; I must edit the configuration files manually or update my rules with additional tools and modules to not face any fail/crash or lack of feature.


## Configuration Files 
snort.conf: Main configuration file.
local.rules: User-generated rules file. 


# Overview of main configuration file (snort.conf)
Command to edit: sudo gedit /etc/snort/snort.conf 
This is what I see after running this command in a terminal: Screenshots/Network Security and Traffic Analysis/02/2.10/Screenshot 2025-07-21 at 1.10.51â€¯PM.png 

<SECTIONS>
"Step #1: Set the network variables" Section 
This section manages the scope of the detection and rule paths. 

These below are the Tag names that I need to know- 
- HOME_NET: That is where we are protecting.
- EXTERNAL_NET: This field is the external network, so we need to keep it as 'any' or '!$HOME_NET'.
- RULE_PATH: Hardcoded rule path.
- SO_RULE_PATH: These rules come with registered and subscriber rules.
- PREPROC_RULE_PATH: These rules come with registered and subscriber rules. 


"Step #2: Configure the decoder" Section.
This section is to manage the IPS mode of snort. The single-node installation model IPS model works best with "afpacket" mode. I can enable this mode and run Snort in IPS. 

These below are the Tag names and their examples that I need to know-  
-#config daq: IPS mode selection, afpacket
-#config daq_mode: Activating the inline mode, inline
-#config logdir: Hardcoded default log path, /var/logs/snort

# DAQ
Data Acquisition Modules (DAQ) are specific libraries used for packet I/O, bringing flexibility to process packets. It is possible to select DAQ type and mode for different purposes.

There are six DAQ modules available in Snort;
1. Pcap: Default mode, known as Sniffer mode.
2. Afpacket: Inline mode, known as IPS mode.
3. Ipq: Inline mode on Linux by using Netfilter. It replaces the snort_inline patch.  
4. Nfq: Inline mode on Linux.
5. Ipfw: Inline on OpenBSD and FreeBSD by using divert sockets, with the pf and ipfw firewalls.
6. Dump: Testing mode of inline and normalisation.
The most popular modes are the default (pcap) and inline/IPS (Afpacket). 


"Step #6: Configure output plugins" section. 
This section manages the outputs of the IDS/IPS actions, such as logging and alerting format details. The default action prompts everything in the console application, so configuring this part will help you use the Snort more efficiently.  



"Step #7: Customise your ruleset" section.
These below are Tagnames and their examples that I need to know- 
#site specific rules: Hardcoded local and user-generated rules path, include $RULE_PATH/local.rules. 
#include $RULE_PATH/: Hardcoded default/downloaded rules path, include $RULE_PATH/rulename.

Note: "#" is commenting operator. You should uncomment a line to activate it.