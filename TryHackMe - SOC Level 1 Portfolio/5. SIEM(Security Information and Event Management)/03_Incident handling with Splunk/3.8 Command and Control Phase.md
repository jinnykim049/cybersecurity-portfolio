# Command and Control: 
The attacker uploaded the file to the server before defacing it. While doing so, the attacker used a Dynamic DNS to resolve a malicious IP.

* Dynamic DNS (DDNS): a service that maps a domain name (like badguy.ddns.net) to an IP address, even if the IP changes frequently. 

=> Attackers use Dynamic DNS (DDNS) to map a domain name (like maliciousname.ddns.net) to their real IP address, especially if the IP changes frequently or they want to hide it. This way, they can update the IP behind the domain without changing the domain itself.
From the user’s perspective, they may:
1. See the domain name in their browser if they directly click a malicious link.
2. Not see it at all if the malware or script connects to it in the background.

Analysts investigate which IP the DDNS domain resolved to (where it actually sent traffic.- This helps identifing the attacker’s infrastructure (e.g., their C2 server)), using DNS logs or traffic logs in tools like Splunk.
 

**Objective** 
Find the IP address that the attacker mapped their DNS domain to. 
This means I need to figure out which IP address the DNS domain (like badguy.ddns.net) was pointing to at the time of the attack. 


**Step by Step instructions**
1. To investigate the communication to and from the adversary's IP addresses, I will be examining the network-centric log sources mentioned above. I will first pick fortigate_utm to review the firewall logs and then move on to the other log sources.

Here is the Search Query: index=botsv1 sourcetype=fortigate_utm"poisonivy-is-coming-for-you-batman.jpeg"

2. Looking into the Fortinet firewall logs, I can see the src IP, destination IP, and URL. 
Then I click *url* field and observe that it contains the FQDN (Fully Qualified Domain Name). 
*FQDN: the complete domain name that uniquely identifies a specific host on the internet. 
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.8/Screenshot 2025-07-25 at 8.16.49 PM.png)

This fulfils Objective, but I can still verify other log sources. 


3. Let's verify the answer by looking at another log source, stream:http.

Search Query: 'index=botsv1 sourcetype=stream:http dest_ip=23.22.63.114 "poisonivy-is-coming-for-you-batman.jpeg" src_ip=192.168.250.70 '


(View image after running this query: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.8/Screenshot 2025-07-25 at 8.31.56 PM.png)

Now, I have identified the suspicious domain as a Command and Control Server, which the attacker contacted after gaining control of the server.

**How did I identify this as a C2 Server?**
Reason 1. Suspicious File Request
- request: GET /poisonivy-is-coming-for-you-batman.jpeg HTTP/1.0
- uri: /poisonivy-is-coming-for-you-batman.jpeg
=> This is not a normal image. The name is unusual and probably doesn’t serve any actual image content. Attackers often disguise malware or commands in files with misleading extensions (like .jpeg, .txt, etc.).

Reason 2. Strange Domain
- site: prankglassinebracket.jumpingcrab.com:1337
=> This is a weird, auto-generated-looking domain hosted on port 1337 — not a standard web port.
Attackers commonly use Dynamic DNS services to create temporary or stealthy domains for C2.
 
Reason 3. Source is the Server
src_ip: 192.168.250.70 ← this is the webserver
dest_ip: 23.22.63.114 ← this is the external suspicious IP
=> The compromised webserver is initiating this outbound connection — not normal behavior for a webserver unless it’s fetching updates or similar. In this case, it's pulling a file from a shady domain.

Reason 4. Connection Looks One-Sided
bytes_out: 0
bytes_in: 106
=> The server downloads data (pulls something in), which could be a payload, a script, or a C2 command — classic behavior after compromise. 


===> 
Therefore, I can conclude that after gaining control of the server, the attacker had it reach out to prankglassinebracket.jumpingcrab.com on port 1337 to download a suspicious payload (poisonivy-is-coming-for-you-batman.jpeg). This suggests that the domain was acting as a Command and Control server, delivering instructions or malware to the compromised machine. 


Note: We can also confirm the domain by looking at the last log source stream:dns to see what DNS queries were sent from the webserver during the infection period.


# Answer the questions below
Q1. This attack used dynamic DNS to resolve to the malicious IP. What fully qualified domain name (FQDN) is associated with this attack?
A1. prankglassinebracket.jumpingcrab.com
This whole chapter is to answer this question. Read the Step by Step instructions above. 


# From this chapter, I learned.. 
1. how attackers use Dynamic DNS to hide their infrastructure and make their IP addresses flexible and harder to track.
2. how to investigate C2 communication by pivoting across multiple log sources to find signs of outbound connections to suspicious domains.

   
**Reflection**
This chapter was really insightful. While it wasn’t too difficult, it showed me how attackers maintain access and control after compromising a system. I enjoyed piecing together the clues and confirming that a weird-looking domain was acting as a Command and Control server. 