# Level title/ Pain to Attacker 
ðŸŸ  Host & Network Artifacts / High 

## What are Network Artifacts? 
:This mean if you can detect and respond to the threat, the attacker would need more time to go back and change his tactics or modify the tools, which gives you more time to respond and detect the upcoming threats or remediate the existing ones.

Common network artifacts include: 
- user-agent string
- C2 information
- URI patterns followed by the HTTP POST requests 

# About User-Agent string: 
An attacker might use a User-Agent string that hasnâ€™t been observed in your environment before or seems out of the ordinary. 
The User-Agent is defined by RFC2616 as the request-header field that contains the information about the user agent originating the request.

**Wireshark PCAPs can detect Network artifacts!** 
Wireshark PCAPs means the file that contains the packet data of a network)by using a network protocol analyzer such as TShark or exploring IDS (Intrusion Detection System) logging from a source such as Snort. 


*An Example command to filter out the User-Agent strings: (Using TShark)
tshark --Y http.request -T fields -e http.host -e http.user_agent -r analysis_file.pcap  


## Lab 2.5 
From the screenshots [Screenshots/02/2.5/Screenshot 2025-06-30 at 3.48.37â€¯PM.png] and [Screenshots/02/2.5/Screenshot 2025-06-30 at 3.29.26â€¯PM.png] which indicates the most common User-Agent strings found for the Emotet Downloader Trojan, 
* Emotet Downloader Trojan: a sophisticated Trojan downloader that primarily spreads through malicious email attachments 


I could identify.. 
1. Internet Explorer uses the User-Agent string, 

From my obervation that the tshark command extracts the http.user_agent field from the pcap file, and the output shows lines like: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)

With internet researching, I noticed that 
Mozilla/4.0: A common compatibility token
MSIE 7.0: Microsoft Internet Explorer 7
Windows NT 6.1: Windows 
Trident/7.0: Rendering engine for IE 11
.NET CLR, Media Center PC: Additional system info often spoofed or added by malware

Then I figured out that this string is most likely associated with Internet Explorer 11 running in compatibility mode (as IE 7) â€” which is commonly spoofed by malware like Emotet.  


2. There are 6 POST requests from the pcap file refer to this screenshot - [Screenshots/02/2.5/Screenshot 2025-06-30 at 3.48.37â€¯PM.png]  
because according to this, there are 6 lines of POST request entries and each of these lines represents a unique HTTP POST request made by the infected host to a Command and Control (C2) server. 

 
 ## From this section, I learned that 
1. Network artifacts like unusual User-Agent strings can be valuable indicators of compromise (IOCs).

2, Emotet often uses spoofed User-Agent strings mimicking Internet Explorer to blend in with normal traffic.

3. PCAP analysis with TShark can quickly extract patterns such as repeated User-Agent strings for threat detection.

4. Detecting such patterns can give defenders a head start in identifying and mitigating malware infections. 