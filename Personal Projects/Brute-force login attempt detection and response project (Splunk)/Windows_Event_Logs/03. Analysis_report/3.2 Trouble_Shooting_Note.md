# Trouble Shooting 
This file is to record where I found trouble and how I resolved it while working on this activity. 

**First Trouble** : Finding a Suitable Dataset 
I first tried to get the log data from external sources such as GitHub (d4rk-d4nph3 / Windows-Event-Samples – https://github.com/d4rk-d4nph3/Windows-Event-Samples).
However, after running some queries, I found that it only gave me very limited results (usually 1 or none). From this, I realized that this data source isn't suitable for detecting brute-force attacks.
Then I looked for other public sample log data, but soon found that most datasets on the internet were not suitable for this project either—just like the one by d4rk-d4nph3—because they were usually too clean due to a lack of volume, detail, or variety. Typically, only 1–2 failed login events would appear after running a query, which is not enough for behavioral analysis.

Therefore, after this struggle, I decided to use AI (ChatGPT) to get auto-generated simulated data. It wrote me a script that generates 500+ 4625 logs with varied IPs and usernames, simulating brute-force activity over 1 hour. This dataset was very effective for this project because (1) it's based on the actual Windows log format, (2) the event structure (Event ID 4625, LogonType, IP, account name, etc.) is configured realistically, and (3) synthetic log simulation is often used by real companies (especially for SIEM tuning and rule testing). Therefore, AI-generated data was suitable for simulation, and I decided to use this dataset.

Note:
When I first tried to use the dataset by d4rk-d4nph3 from his GitHub, I had to convert the log file to a JSON file so Splunk could ingest it. Even though I ended up not using this data source, I believe it is useful to know—so I’ve kept the data and conversion instructions in this portfolio, located at:
Personal Projects/Brute-force login attempt detection and response project (Splunk)/Windows_Event_Logs/01. Data/Convert_Data 

* In short: 
Issue: Publicly available datasets (e.g., d4rk-d4nph3's) were too limited for brute-force detection
Cause: Most public datasets lacked sufficient volume, detail, or failed login variety
Solution: Used ChatGPT-4o to generate synthetic Event ID 4625 logs that realistically simulate brute-force attacks 




**Second Trouble** : AccountName Not Showing in Query Results 
To detect the potential Brute-Force attack, I first ran this query:
 
source="sample_windows_event_log.json" host="Jinnys-MacBook-Pro.local" index="splunk_project_index" sourcetype="_json"  
| spath
| search EventID=4625
| rex field=Message "Account Name:\s+\t*(?<AccountName>[^\r\n]+)"
| rex field=Message "Source Network Address:\t+(?<SourceIP>\S+)"
| stats count by SourceIP, AccountName
| sort -count

However, the AccountName field did not appear in the results.
(View image: Personal Projects/Brute-force login attempt detection and response project (Splunk)/Windows_Event_Logs/Appendix/Screenshots/Screenshot 2025-08-03 at 8.06.20 PM.png)

To resolve this issue, I reviewed the raw log data again and realized the 1) issue was caused by the combination of '\t' (tab) and '\r\n' (line break) characters in the message string. These were interfering with the regex extraction, preventing the AccountName field from being parsed correctly. 

Therefore, I modified the rex pattern by adding the (?s) flag. This allows the dot (.) to match newline characters, making it possible to extract AccountName even when line breaks are present.

There was also 2) another problem. The Account Name field appears multiple times in the log message, and the original regex was matching the wrong occurrence.
To resolve this, I narrowed the search scope by anchoring the regex to the "Account For Which Logon Failed" section, and added the (?s) flag to handle multi-line parsing. This ensured the correct AccountName value was extracted for analysis. 

(View image: Personal Projects/Brute-force login attempt detection and response project (Splunk)/Windows_Event_Logs/Appendix/Screenshots/Screenshot 2025-08-03 at 8.14.28 PM.png)
 

Updated query: 
source="sample_windows_event_log.json" host="Jinnys-MacBook-Pro.local" index="splunk_project_index" sourcetype="_json" 
| spath
| search EventID=4625
| rex field=Message "(?s)Account For Which Logon Failed:.*?Account Name:\t(?<AccountName>[^\r\n]+)"
| rex field=Message "Source Network Address:\t(?<SourceIP>\S+)"
| stats count by SourceIP, AccountName
| sort -count


and below is the result after running this query-
(View image: Personal Projects/Brute-force login attempt detection and response project (Splunk)/Windows_Event_Logs/Appendix/Screenshots/Screenshot 2025-08-03 at 8.16.36 PM.png)
 
* In short,  
Issue: AccountName field was not being extracted from the raw event log
Cause: Regex failed due to newline + tab formatting and multiple matching entries
Solution: Anchored regex to the correct section and added the (?s) flag to support multi-line parsing


