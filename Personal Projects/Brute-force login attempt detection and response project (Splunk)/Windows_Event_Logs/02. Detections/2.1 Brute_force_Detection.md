< Step by Step Process >
# Step 1: Log Data Collection and Preparation
To simulate a realistic brute-force attack scenario, I used a synthetic Windows Event Log dataset generated with AI- ChatGPT-4o.

You can view the dataset here:
(Personal Projects/Brute-force login attempt detection and response project (Splunk)/Windows_Event_Logs/01. Data/sample_windows_event_log.json)
 
and find more information about my chosen dataset under (Brute-force login attempt detection and response project (Splunk)/Windows_Event_Logs/01. Data)


# Step 2: Data Ingestion into Splunk
Next, I launched Splunk, then navigated to:
"Settings -> Add Data -> Upload File"

I selected the sample_windows_event_log.json file from my device and followed the guided process to index the data.

Below is Key ingestion configuration:
Source type: json
Index: splunk_project_index 
-> I avoided to use the default index (main) because Splunk puts all the test/sample/default logs in the main by default, so it can be mixed with other data when querying later. 
 

# Step 3: Brute-force Login Attempt Detection using SPL
**Objective** - Detect potential brute-force login attempts by identifying repeated failed login events (Event ID 4625) from the 'sample_windows_event_log.json' dataset.

**Detection Logic**
Indicators of a brute-force attack:
  - A high number of failed logon attempts from the same SourceIP
  - Multiple failed attempts originating from the same external IP targeting the same AccountName
  - LogonType 3 (network logon) —> often used in external remote brute-force attacks 

**SPL Query**
source="sample_windows_event_log.json" host="Jinnys-MacBook-Pro.local" index="splunk_project_index" sourcetype="_json" 
| spath
| search EventID=4625
| rex field=Message "(?s)Account For Which Logon Failed:.*?Account Name:\t(?<AccountName>[^\r\n]+)"
| rex field=Message "Source Network Address:\t(?<SourceIP>\S+)"
| stats count by SourceIP, AccountName
| sort -count
 

Explanation -> This query is to identify IPs repeatedly trying and failing to log into specific user accounts. It tells who (AccountName) was targeted, from where (SourceIP), how many times (count), and most aggressive attack sources (at the top)


In detail- 
Line 31: to specify the data source.
Line 32: to parse the structured JSON fields. (spath enables accessing nested JSON fields as separate searchable fields. Without it, Splunk may treat the entire event as a raw string.)
Line 33: to filter for Windows Event ID 4625 - which is Failed Logon Attempt. 

Line 34: to extract the AccountName from the raw Message field. (rex: regular expression)
- (?s): Enables multiline mode so . matches newline characters.
- Account For Which Logon Failed:.*?Account Name:\t matches the section preceding the actual username.
- (?<AccountName>[^\r\n]+): captures the actual account name, stopping at newline or carriage return. 

Line 35: to extract the IP address of the device attempting the login. 
- Source Network Address:\t :matches the label.
- (?<SourceIP>\S+): captures the non-space characters after the tab — the actual IP address.
Source Network Address:\t matches the label.

Line 36: to aggregate the number of failed login attempts by each SourceIP and AccountName pair.
Line 37: to sort the results in descending order by the number of attempts.


After running this query, I got to see this result - (View image: Personal Projects/Brute-force login attempt detection and response project (Splunk)/Windows_Event_Logs/Appendix/Screenshots/Screenshot 2025-08-03 at 8.26.05 PM.png). 

-Bonus: 
I could also add this below to the query.
"| rex field=Message "Logon Type:\t+(?<LogonType>\d+)"
| where LogonType == "3"  "
-> This query is to filter by LogonType 3 which is network logon that is triggered when a user logs in over the network (e.g., SMB, remote connections). 
These lines are good to include because LogonType 3 is the most common logon type in remote brute-force attempts. 

* Final query: 
**SPL Query to detect Brute-Force attacks**  
source="sample_windows_event_log.json" host="Jinnys-MacBook-Pro.local" index="splunk_project_index" sourcetype="_json"
| spath
| search EventID=4625
| rex field=Message "(?s)Account For Which Logon Failed:.*?Account Name:\t(?<AccountName>[^\r\n]+)"
| rex field=Message "Source Network Address:\t(?<SourceIP>\S+)"
| rex field=Message "Logon Type:\t+(?<LogonType>\d+)"
| where LogonType == "3"
| stats count by SourceIP, AccountName
| sort -count



After running this query, I got to see this result - (View image: Personal Projects/Brute-force login attempt detection and response project (Splunk)/Windows_Event_Logs/Appendix/Screenshots/Screenshot 2025-08-03 at 8.45.43 PM.png).


Then I could conclude that there were 250 failed logons (250 events have Event ID: 4625)out of 850 activities, and out of 250 failed logons, there were 86 unique combinations of SourceIP and AccountName - each shown once with a count of how many times it occurred. 
The most aggressive Brute-Force attacks was from IP address 203.0.113.45 with AccountName: testuser with 32 login attempts within an hour.  