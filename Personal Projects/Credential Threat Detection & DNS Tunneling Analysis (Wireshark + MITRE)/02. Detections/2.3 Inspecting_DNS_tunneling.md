**Objective**
Verify that DNS traffic contains signs of DNS tunneling, which adversaries can use to exfiltrate data or establish C2 channels using DNS protocol.  


* DNS tunneling: a technique where data is encoded into DNS queries and responses, usually through subdomains, allowing attackers to bypass firewalls or proxy filters by abusing legitimate-looking DNS traffic.



# Step 1:  Open the tunnel_example.pcap file with WireShark. 
I used "tunnel_example.pcap" file for to inspect for DNS tunneling traffic.

This is what I first saw after opening the file in WireShark.

(View image: Personal Projects/Credential Threat Detection & DNS Tunneling Analysis (Wireshark + MITRE)/Appendix/Screenshots/Screenshot 2025-08-05 at 11.36.24 PM.png).

I observed that many packets had Protocol: DNS and were sent over UDP port 53, the standard port used for DNS queries.
This is confirmed by inspecting individual packet details, where the destination port is shown as 53 under the UDP section. 



# Step 2: Apply Display Filter to View DNS Traffic 
To isolate DNS traffic, I applied the following Wireshark display filter. 

**Filter used:** 
dns 


(View image after applying this filter: Personal Projects/Credential Threat Detection & DNS Tunneling Analysis (Wireshark + MITRE)/Appendix/Screenshots/Screenshot 2025-08-05 at 11.52.49 PM.png)

-> This filter showed numerous DNS TXT queries and responses between IP 172.20.10.5 and 172.20.10.6. 







#  Step 3: Inspect Encoded Subdomain Patterns 
 
After applying the dns filter in Wireshark, I observed multiple DNS TXT queries sent from 172.20.10.5 to 172.20.10.6.
These queries repeatedly targeted the base domain .tunnel.onetwog.leb.tech, but with highly variable and long subdomains like: HTiGLAamBA.tunnel.onetwog.leb.tech
HTiGKqjaBA.tunnel.onetwog.leb.tech

The uniform structure and randomness of the subdomain strings suggest that the client is embedding endcoded data (likely base64 or custom-encoded chunks) into DNS queries. This is a technique known as DNS tunneling.

Additionally, the consistent use of the TXT record type supports this, as TXT records are commonly abused for command-and-control or data exfiltration purposes as TXT records can carry arbitrary data.  

High volumes of DNS queries in short bursts are also a strong indicator of DNS tunneling because typically, DNS queries are sporadic, triggered by user activity or application needs, and do not occur continuously within milliseconds. 
However, DNS tunneling tools split data into small chunks and rapidly send them as part of subdomain queries to exfiltrate data or establish covert communication channels. This automated and repetitive query pattern suggests that DNS is being abused as a transport layer for hidden data transfer. 



# Step 4: Analyze 
This kind of traffic does not represent standard DNS behavior.

Instead, the combination of long, structured subdomains and repeated use of the same base domain indicates DNS tunneling, a technique used to bypass firewalls, evade detection, exfiltrate data covertly and maintain command-and-control (C2) access. 

Since DNS traffic is often allowed through perimeter defenses and rarely inspected deeply, this technique is favored by APTs (Advanced Persistent Threats) and red teamers for stealthy persistence or data theft. 