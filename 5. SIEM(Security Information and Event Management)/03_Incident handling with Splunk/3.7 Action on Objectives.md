# Action on Objective
In this chapter, I am going to understand what ended up on the website that caused defacement.

**Step by step instructions**
1. To do that, I first need to figure out the traffic flow. (There can be a different approach to understand it too..)
Then I will start the investigation by examining the Suricata log source and the IP addresses communicating with the webserver 192.168.250.70.

Here is the Search query. 
:'index=botsv1 dest=192.168.250.70 sourcetype=suricata' 


2. Then I found only two IP addresses (192.168.2.50 (Count 211, 50.119%) and 192.168.250.70 (Count 210, 49.881%)). 

Let's investigate the ip 192.168.2.50 first wit this Search query: 
'index=botsv1 src=192.168.250.70 sourcetype=suricata'

3. (View image of the result from Step2: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.7/Screenshot 2025-07-25 at 6.44.35 PM.png). 
Here is the interesting part. Usually, the web servers do NOT originate the traffic. The browser or the client would be the source, and the server would be the destination. Here I see three external IPs towards which the web server initiates the outbound traffic.

There is a large chunk of traffic going to these external IP addresses, which could be worth checking.

I am going to pivot into the destination IPs one by one to see what kind of traffic/communication is being carried out with this search query.: 
'index=botsv1 src=192.168.250.70 sourcetype=suricata dest_ip=23.22.63.114'


4. The URL field shows 2 PHP files and one jpeg file. This jpeg file's name is 'poisonivy-is-coming-for-you-batman.jpeg' and it is very suspicious, so I will change the search query and see where this jpeg file came from.

Search Query: 'index=botsv1 url="/poisonivy-is-coming-for-you-batman.jpeg" dest_ip="192.168.250.70" | table _time src dest_ip http.hostname url' 


5. Then I could find that this suspicious jpeg file was downloaded from the attacker's host'prankglassinebracket.jumpingcrab.com' that defaced the site.
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.7/Screenshot 2025-07-25 at 6.50.23 PM.png)

 


# Answer the questions below: 
Q1. What is the name of the file that defaced the imreallynotbatman.com website ?
A1. prankglassinebracket.jumpingcrab.com

Check Step 1-5 from the above. 

Q2. Fortigate Firewall 'fortigate_utm' detected SQL attempt from the attacker's IP 40.80.148.42. What is the name of the rule that was triggered during the SQL Injection attempt? 
A2. HTTP.URI.SQL.Injection 

After reading the question, I knew that I had to run this Search Query, 'index=botsv1 sourcetype="fortigate_utm" src=40.80.148.42'.  I needed to know the name of the rule that was triggered during the attempt, so clicked on *attack* field from the left panel. 
Then I was able to find the answer with the title 'SQL.Injection'. 
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.7/Screenshot 2025-07-25 at 7.02.31 PM.png)



# From this chapter, I learned...  
1. how to spot unusual behavior, like a web server making outbound connections—something it normally shouldn't do.
2. how to trace suspicious files like the defacement image back to their source using Suricata logs and URL fields.
3. how firewalls like Fortigate detect specific attacks (like SQL injection) using named rules.
4. That small clues (like a weird image name) can reveal bigger signs of compromise. 

# Reflection
This chapter was pretty easy but really interesting. I liked seeing how firewall logs play a role in spotting attack attempts. I also enjoyed the process of detecting who did what. It felt like being a detective, but on the internet. 

