# Exploitation Phase 
**About Exploitation phase**
The attacker needs to exploit the vulnerability to gain access to the system/server.

**here is what I'm going to learn in this page.**
This chapter will teach me to look at the potential exploitation attempt from the attacker against the web server and I will see if the attacker got successful in exploiting or not.

Important note that I have so far: 
- There were two IP addresses from the reconnaissance phase with sending requests to the server.
- One of the IPs 40.80.148.42 was seen attempting to scan the server with IP 192.168.250.70.
- The attacker was using the web scanner Acunetix for the scanning attempt.

**Step by step instructions for Exploitation Phase.**
# Count
* Info 1. I can see the number of counts by each source IP against the webserver with this search query: 

"index=botsv1 imreallynotbatman.com sourcetype=stream* | stats count(src_ip) as Requests by src_ip | sort - Requests" 

=> This query uses the stats function to display the count of the IP addresses in the field src_ip. 

I can also create different visualization to show the result. Click on Visualization → Select Visualization 
The Pie char table shows that the IP address 40.80.148.42 dominants over the IP address 23.22.63.114. 

* Info 2. Then I will narrow down the result to show requests sent to the web server, which has the IP 192.168.250.70

Search query: 'index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70"'

=> : This query will look for all the inbound traffic towards IP 192.168.250.70. 

The result in the *src_ip* field shows two IP addresses sending all the POST requests to the server.

Below are some interesting fields containing valuable information.  
*src_ip
form_data
http_user_agent
uri *

The term Joomla is associated with the webserver found in a couple of fields like uri, uri_path, http_referrer, etc. This means the webserver is using Joomla CMS (Content Management Service) in the backend.

A little search on the internet for the admin login page of the Joomla CMS will show as -> /joomla/administrator/index.php

It is important because this uri contains the login page to access the web portal therefore I will be examining the traffic coming into this admin panel for a potential brute-force attack. 




* Info 3. Narrowing down the search to see the requests sent to the login portal with this (Reference: https://www.joomla.org/administrator/index.php). 

Search query: 'index=botsv1 imreallynotbatman.com sourcetype=stream:http dest_ip="192.168.250.70"  uri="/joomla/administrator/index.php" '


*form_data* field contains the requests sent through the form on the admin panel page, which has a login page. I can suspect the attacker may have tried multiple credentials in an attempt to gain access to the admin panel. To confirm, I will dig deep into the values contained within the form_data field. 

To do that, let me change the search query from the above.  

New Search Query: 'index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70" http_method=POST uri="/joomla/administrator/index.php" | table _time uri src_ip dest_ip form_data'

=> I  added this -> '| table _time uri src_ip dest_ip form_data' to create a table containing important fields. 

If I keep looking at the results, I will find two interesting fields username that includes the single username admin in all the events and another field passwd that contains multiple passwords in it, which shows the attacker from the IP 23.22.63.114 was trying to guess the password by brute-forcing and attempting numerous passwords.

The time elapsed between multiple events also suggests that the attacker was using an automated tool as various attempts were observed in a short time. 


# Extracting Username and Passwd Fields using Regex 
Looking into the logs, I see that these fields are not parsed properly. I will use *Regex* in the search to extract only these two fields and their values from the logs and display them.

I can display only the logs that contain the username and passwd values in the form_data field by adding 'form_data=*username*passwd*' in the above search. 

Therefore, Search Query: 'index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70" http_method=POST uri="/joomla/administrator/index.php" form_data=*username*passwd* | table _time uri src_ip dest_ip form_data'

Then Regex appears HERE! 
Regex (Regualr Expressions) extracts all the password values found against the field passwd in the logs. If I type rex in the search head, it will show detail and an example of how to use it to extract the values. 

Here is the search query: 'rex field=form_data "passwd=(?<creds>\w+)"'. Again, it is to extract passwd values only. 
This will pick the *form_data* field and extract all the values found with the *creds* field. 

Search Query:'index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70" http_method=POST form_data=*username*passwd* | rex field=form_data "passwd=(?<creds>\w+)"  | table src_ip creds '

With this, I have extracted the passwords being used against the username admin on the admin panel of the webserver. If I examine the fields in the logs, I will find two values against the field http_user_agent. 
This is what I see: 
(Python: count 412 (99.758%), Mozilla: count 1 (0.242%))

This clearly shows attacker used a python script to automate the brute force attack against our server. 

But What about one request from Mozilla browser? 
Let's slightly change to the about search query and add http_user_agent a field in the search head. (to check more details)

Search Query: 'index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70" http_method=POST form_data=*username*passwd* | rex field=form_data "passwd=(?<creds>\w+)" |table _time src_ip uri http_user_agent creds '

=> (view the result: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.5/Screenshot 2025-07-25 at 4.05.54 PM.png) It clearly shows a continuous brute-force attack attempt from an IP 23.22.63.114 and 1 password attempt batman from IP 40.80.148.42 using the Mozilla browser. 


# Answer the questions below
Q1. What was the URI which got multiple brute force attempts?
A1. /joomla/administrator/index.php 

/joomla/administrator/index.php is the admin login page of the Joomla CMS

Q2. Against which username was the brute force attempt made?
A2. admin
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.5/Screenshot 2025-07-25 at 4.09.35 PM.png)

I got this result after running this search query: 'index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70" http_method=POST uri="/joomla/administrator/index.php" | table _time uri src_ip dest_ip form_data'


Q3. What was the correct password for admin access to the content management system running imreallynotbatman.com?
A3. batman

After running this search, 'index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70" http_method=POST uri="/joomla/administrator/index.php" form_data=*username*passwd* | table _time uri src_ip dest_ip form_data', 
I could see that the most recent login credential was username: admin and password: batman. Since it was the last login attempt, I could determine that the login was successful and the attacker was able to access the website as an administrator.
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.5/Screenshot 2025-07-25 at 4.38.33 PM.png)


Q4. How many unique passwords were attempted in the brute force attempt?
A4. 412 

This Search Query ('index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70" http_method=POST form_data=*username*passwd* | rex field=form_data "passwd=(?<creds>\w+)"  | table src_ip creds') is to extract only password values from the login attempts.  From this query and *http_user_agent* field,  I found that there were 412 login attempts with Python script and 1 login attempt with Mozila browser. 
Since Brute Force was attempting with Python script, I could confirm that there were 412 unique passwords with this Brute force attack. 
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.5/Screenshot 2025-07-25 at 4.53.22 PM.png)

Note: This attempt was conducted with the same username and different password, and I know that there are no attempts with the same credential that was once failed to log-in. Therefore, I could conclude that all the passwords from all 412 attempts were unique. 


Q5. What IP address is likely attempting a brute force password attack against imreallynotbatman.com?
A5. 23.22.63.114 

I checked the src_ip of the python script agent (brute-force attempt) after running this search query. 
'index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70" http_method=POST uri="/joomla/administrator/index.php" form_data=*username*passwd* | table _time uri src_ip dest_ip form_data'. It was 23.22.63.114

(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.5/Screenshot 2025-07-25 at 5.28.08 PM.png)


Q6. After finding the correct password, which IP did the attacker use to log in to the admin panel?
A6. 40.80.148.42

I checked the src_ip of the successful login credential (username:admin password:batman). It was 40.80.148.42

(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.5/Screenshot 2025-07-25 at 5.30.01 PM.png)


# From this chapter, I learned... 
1. how to identify and investigate brute-force attacks.
I learned how to use specific search queries to detect login attempts, extract usernames and passwords from logs using regex, and confirm whether login attempts were successful.

2. how to analyze attacker behavior using Splunk logs.
By checking http_user_agent and time patterns, I was able to tell that the attacker used a Python script to automate brute-force attacks.
 

**Reflection** 
This activity was pretty straightforward. Once I understood the structure of the logs, finding the brute-force attempts and successful login was easy. Using regex to extract fields was simple, and I was able to extract what I needed. It was not only fun, but gave me more confidence working with Splunk and analyzing web-based attacks. This lab showed me how useful Splunk can be for identifying real attacker behavior, and with more practice, I’ll get faster and more confident.  