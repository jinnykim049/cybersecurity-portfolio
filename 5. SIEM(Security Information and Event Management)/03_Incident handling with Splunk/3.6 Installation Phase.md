# Installation Phase 
**About Installation phase**
Once the attacker has successfully exploited the security of a system, he will try to install a backdoor or an application for persistence or to gain more control of the system. This activity comes under the installation phase.

**here is what I'm going to learn in this page.**
Now I know that the webserver is getting compromised via brute-force attack by the attacker using the python script. This phase will investigate any payload / malicious program uploaded to the server from any attacker's IPs and installed into the compromised server.

**Step by step instructions for Exploitation Phase.** 

1. To begin an investigation, I first would narrow down any http traffic coming into our server 192.168.250.70 containing the term ".exe."  (Malware is often delivered as .exe (Windows Executable File) files)

Search Query: 'index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70" *.exe '

2. Then I see the field part_filename{} contain the two file names. an executable file '3791.exe' and a PHP 'file agent.php' 

3. Next, I need to find if any of these files came from the IP addresses that were found to be associated with the attack earlier. After I click on the file name, it will be added to the search query, then I can look for the field c_ip (client IP).

Search Query:'index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70" "part_filename{}"="3791.exe" '

4. I have found that file '3791.exe' was uploaded on the server. Now I need to answer this question: "Was this file executed on the server after being uploaded?" Now, I need to narrow down the search query to show the logs from the host-centric log sources to answer this question.

Search Query: 'index=botsv1 "3791.exe"' 

5. I need to confirm if the file is executed after upload. Then I check host-centric logs, the logs that track what happens on the server itself. 
For example, 
-Sysmon
-WinEventlog
-fortigate_utm

For the evidence of execution, I can leverage sysmon and look at the EventCode=1 for program execution.

Reference: https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon 

*Why EventCode=1?: 
EventCode=1 means Process creation. When some executable is run, Sysmon logs it with EventCode=1. 
The full command line provides context on the process execution. 

Therefore, I can run this search query: 
'index=botsv1 "3791.exe" sourcetype="XmlWinEventLog" EventCode=1'

6. Then, I can clearly say that this file was executed on the compromised server. 
Note that I can also look at other host-centric log sources to confirm the result. 
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.6/Screenshot 2025-07-25 at 6.02.07 PM.png) 



# Answer the questions below
Q1. Sysmon also collects the Hash value of the processes being created. What is the MD5 HASH of the program 3791.exe?
A1. AAE3F5A29935E6ABCC2C2754D12A9AF0

This is how I did: 
1. I first clicked on *CommandLine* field to check the executed file and clicked on 3791.exe value 
((View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.6/Screenshot 2025-07-25 at 6.02.07 PM.png) )
2. I got only 1 result, and then I looked for MD5 Hash value which was AAE3F5A29935E6ABCC2C2754D12A9AF0. 
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.6/Screenshot 2025-07-25 at 6.14.18 PM.png)



Q2. Looking at the logs, which user executed the program 3791.exe on the server?
A2. NT AUTHORITY\IUSR 

On the same screen from Q1, I found the user data. 
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.6/Screenshot 2025-07-25 at 6.17.28 PM.png)
Or I could use *User* field from the left panel to find it. 
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.6/Screenshot 2025-07-25 at 6.19.25 PM.png)

Q3. Search hash on the virustotal. What other name is associated with this file 3791.exe?
A3. ab.exe

I went to https://www.virustotal.com/gui/home/upload and searched for the hash. I found that the other name for this file was ab.exe. 
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.6/Screenshot 2025-07-25 at 6.23.38 PM.png)



# From this chapter, I learned... 
1. how to trace the installation of a malicious executable on a compromised server. 
2. how to use Sysmon logs to confirm execution using EventCode=1. I learned Splunk can track file uploads with HTTP logs and then pivot to host-centric logs like Sysmon to confirm whether those files were actually executed.
3. how to find key details like MD5 hash, execution user, and related file names via Splunk. 
4. how to leverage external resources like VirusTotal to research the reputation and alternative names of suspicious files, which aids in threat intelligence and response. 

**Reflection**
This chapter was both engaging and manageable. Especially confirming actual execution on the host through Sysmon logs was interesting because it made the attack’s progression more tangible and reinforced the importance of combining different log sources for a thorough investigation. 

Overall, this phase felt straightforward but also critical. It really highlighted how attackers establish a foothold after exploiting a system  