# Reconnaissance Phase
Reconnaissance is an attempt to discover and collect information about a target. It could be knowledge about the system in use, the web application, employees or location, etc.

I will start the analysis by examining any reconnaissance attempt against the webserver 'imreallynotbatman.com'.


<STEP 1> 
*first loook*
From an analyst perspective, where do I first need to look? If I look at the available log sources, I will find some log sources covering the network traffic, which means all the inbound communication towards the web server will be logged into the log source that contains the web traffic.

I can start by searching for the domain in the search head and see which log source includes the traces of our domain.

Search Query: "index=botsv1 imreallynotbatman.com"

-> this looks for the event logs in the index "botsv1" which contains the term imreallynotbatman.com 

<STEP2> 
I have searched for the term imreallynotbatman.com in the index botsv1, and saw the following log sources in the sourcetype field.  

Suricata
stream:http
fortigate_utm
iis

I need to identify the IP address attempting to perform reconnaissance activity on the web server. 
So I will look at the web traffic coming into the network with start looking into any of the logs mentioned above sources.

-'stream:http'
It contains the http traffic logs, and examine the src_ip field from the left panel. Src_ip field contains the source IP address it finds in the logs.

Search Query: "index=botsv1 imreallynotbatman.com sourcetype=stream:http" 

=> This query will only look for the term  'imreallynotbatman.com' in the stream:http log source. 

Note: if I don't find the field of interest, keep scrolling in the left panel, and when I click on a field, it will contain all the values it finds in the logs.

<STEP3>
From the Search Query: "index=botsv1 imreallynotbatman.com, I could find two IPs in the src_ip field '40.80.148.42' and '23.22.63.114.' (View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.4/Screenshot 2025-07-22 at 6.50.59 PM.png)

The first IP seems to contain a high percentage of the logs as compared to the other IP, which could be the answer. 

To further confirm this suspicion about the IP address 40.80.148.42, I can click on the IP and examine the logs. 
There are interesting fields to look at, like User-Agent, Post request, URIs, etc., to see what kind of traffic is coming from this particular IP. 

<Step4>
Now I need to validate the IP that is scanning. 
I can look into the 'suricata' logs, and see if any rule is triggered on this communication.

Search Query: "index=botsv1 imreallynotbatman.com src=40.80.148.42 sourcetype=suricata"

=> This query will show the logs from the suricata log source that are detected/generated from the source IP 40.80.248.42 


I have narrowed the search on the src IP and looked at the source type suricata to see what Suricata triggered alerts. In the left panel, I could not find the field of my interest, so I clicked on more fields and searched for the fields that contained the signature alerts information.

 
# Lab 3.4 Splunk 
# Answer the questions below: 
Q1. One suricata alert highlighted the CVE value associated with the attack attempt. What is the CVE value? 
A1. CVE-2014-6271


* This is what I did: 
1. 
I searched the query "index=botsv1 imreallynotbatman.com sourcetype="suricata" src_ip="40.80.148.42" 

Why this query?- 
index=botsv1: The botsv1 index is where all event logs are stored. This searches for events that contain the term imreallynotbatman.com within this index.  
sourcetype="suricata" : this acts as a filter to shows events logs that are generated by Suricata IDS. Threfore, I could only check potentially intrusive activities with this. 
src_ip="40.80.148.42" : 40.80.148.42 source ip address must be investigated because it contains a high percentage of the logs (94.424%) so very suspicious. 


2. 

From the left panel, I clicked alert.signature under the Fields section. Then I observed that Suricata marked some events as Possible CVE-2014-6271 
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.4/Screenshot 2025-07-22 at 8.37.39 PM.png)



Q2. What is the CMS our web server is using? 
A2. joomla

* This is what I did: 

1. CMS is Content Management System, a software platform that allows users to create, manage, and update website content without needing to write much code. 

I did some research on CMS, and found out each CMS had its own url. Therefore, I looked for uri Field, and observed that joomla is the CMS the webserver is using. 

(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.4/Screenshot 2025-07-22 at 9.04.26 PM.png)


Q3. What is the web scanner, the attacker used to perform the scanning attempts? 
A3. Acunetix

I knew I had to look for field names that started with http~ (because I wanted to identify the 'web' scanner).
I checked the http_method field, since HTTP methods are part of how attackers interact with web servers. Unusual or rare methods can indicate that a scanner is there. 
Then I found the term “Acunetix,” a well-known web vulnerability scanner. 

(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.4/Screenshot 2025-07-22 at 9.17.37 PM.png)




Q4. What is the IP address of the server imreallynotbatman.com? 
A4. 40.80.148.42

Since all data presented is for imreallynotbatman.com, I can easily get the IP address of the server imreallynotbatman.com. 
It is there in every event as a destination ip. Looking into any fields was not needed. 
(View image: 5. SIEM(Security Information and Event Management)/Screenshots/03/3.4/Screenshot 2025-07-22 at 9.23.49 PM.png)


# From this lab, I learned.. 
1. how to detect reconnaissance activity in Splunk using specific log sources.
I learned how to use search queries to narrow down events based on domain, IP address, and sourcetype. By focusing on logs from sources like stream:http and suricata, I was able to trace suspicious activity targeting a web server.

2. how to investigate indicators of compromise (IOCs) such as suspicious IP addresses and User-Agent strings.
I used fields like src_ip, http_user_agent, and uri to gather insights on attacker behavior, including tools and methods used during reconnaissance.

3. how to identify the attack tool and vulnerability exploited.
By exploring suricata logs and HTTP traffic, I recognized that the attacker used the Acunetix web scanner and attempted to exploit CVE-2014-6271 (Shellshock vulnerability).

4. how to correlate events across different log sources.

# Reflection 
This exercise helped me understand the importance of cross-referencing events to build a complete picture of the attack scenario. I also realized the value of field exploration in Splunk. When a relevant field wasn’t immediately visible, I learned to use the “More fields” option to uncover hidden insights like alert.signature.
There were times when I got stuck trying to find the location of the specific data I needed to check. However, it was genuinely fun to explore different fields and analyze both the questions and data traits to figure out where to look. I felt really proud of myself when I was finally able to answer the questions (especially Question 2, which took me a long time to solve.) Even though I felt stuck at times, once I figured out the answer, I realized it wasn’t actually that difficult to find.
I believe that with more practice, I’ll be able to answer these types of lab questions more quickly and efficiently (with fewer steps and more confidence.) 