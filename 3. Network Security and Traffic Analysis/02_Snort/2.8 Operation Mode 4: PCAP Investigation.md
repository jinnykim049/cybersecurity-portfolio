# Run Snort in PCAP Investigation mode. 
PCAP read/investigate mode helps working with pcap files. Once I have a pcap file and process it with Snort, I will receive default traffic statistics with alerts depending on the ruleset.

(*PCAP: Packet capture (PCAP)- a networking practice involving the interception of data packets travelling over a network. Once the packets are captured, they can be stored/analyzed by IT teams.)

Investigating the pcap with Snort benefits from the rules and speeds up the investigation process by using the known patterns of threats. 


## PARAMETERS 
-------------------------------------------------------
-r / --pcap-single=: Read a single pcap 
--pcap-list="": Read pcaps provided in command (space separated). 
--pcap-show: Show pcap name on console during processing. 
-------------------------------------------------------

Below is more details about the parameters. 
 
* PARAMETERS- 
# 1. Investigating single PCAP with parameter "-r"
Run this command: sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console -n 10 


and I would see this below: 

--------------------------------------------------
 snort identified the traffic and prompted the alerts according to our ruleset.

$ sudo snort -c /etc/snort/snort.conf -q -r icmp-test.pcap -A console -n 10

12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
12/12-12:13:29.200543  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
12/12-12:13:30.169785  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
12/12-12:13:30.201470  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
12/12-12:13:31.172101  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
12/12-12:13:31.204104  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
12/12-12:13:32.174106  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
12/12-12:13:32.208683  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
12/12-12:13:33.176920  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
12/12-12:13:33.208359  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129

-------------------------------------------------- 
As above (the output), the ICMP rule got a hit! snort identified the traffic and prompted the alerts according to our ruleset.



# 2. Investigating multiple PCAPs with parameter "--pcap-show"

Run this command- "sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console --pcap-show"
and I would see this below
--------------------------------------------------
$ sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console

12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
12/12-12:13:29.200543  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
12/12-12:13:30.169785  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
12/12-12:13:30.201470  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
12/12-12:13:31.172101  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
...
12/12-12:13:31.204104  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
12/12-12:13:32.174106  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
12/12-12:13:32.208683  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
12/12-12:13:33.176920  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
12/12-12:13:33.208359  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
--------------------------------------------------As above (the output), the ICMP rule got a hit! Snort identified the traffic and prompted the alerts according to our ruleset.

Note: I have processed two pcaps, and there are lots of alerts, so it is impossible to match the alerts with provided pcaps without snort's help. Therefore, I need to separate the pcap process to identify the source of the alerts. 



# 3. Investigating multiple PCAPs with parameter "--pcap-show" 
Run this command: "sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console --pcap-show " to investigate multiple pcaps, distinguish each one, and see what will happen. 

This is what I will see after running the command: 
--------------------------------------------------
$ sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console --pcap-show 

Reading network traffic from "icmp-test.pcap" with snaplen = 1514
12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
12/12-12:13:29.200543  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
12/12-12:13:30.169785  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
...

Reading network traffic from "http2.pcap" with snaplen = 1514
12/12-12:13:35.213176  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
12/12-12:13:36.182950  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
12/12-12:13:38.223470  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
... 
--------------------------------------------------As above (the output), the ICMP rule got a hit! 
Snort identified the traffic, distinguished each pcap file and prompted the alerts according to our ruleset. 



## Lab 
Use the attached VM and navigate to the Task-Exercises/Exercise-Files/TASK-8 folder to answer the questions. 

Q1. Investigate the mx-1.pcap file with the default configuration file. What is the number of the generated alerts?
A1. 170 

* Here is what I did: 
1. I navigated to Task-Exercises/Exercise-Files/TASK-8 and ran this command: 
sudo snort -c /etc/snort/snort.conf -A full -l . -r mx-1.pcap
(View image: Screenshots/Network Security and Traffic Analysis/02/2.8/Screenshot 2025-07-20 at 5.03.44 PM.png)

2. Then scrolled down to find the number of the generated alerts. 
(View image: Screenshots/Network Security and Traffic Analysis/02/2.8/Screenshot 2025-07-20 at 5.05.31 PM.png)


Q2. Keep reading the output. How many TCP Segments are Queued? 
A2. 18

Starting from Q1 terminal, I scrolled a little further down to check the number of TCP Segments Queued.
(View image: Screenshots/Network Security and Traffic Analysis/02/2.8/Screenshot 2025-07-20 at 5.09.07 PM.png)


Q3. Keep reading the output.How many "HTTP response headers" were extracted? 
A3. 3

Starting from Q2 terminal, I scrolled a little further down to check the number of HTTP response headers extracted. 
(View image: Screenshots/Network Security and Traffic Analysis/02/2.8/Screenshot 2025-07-20 at 5.11.26 PM.png)


Q4. Investigate the mx-1.pcap file with the second configuration file.
What is the number of the generated alerts?
A4. 68

* Here is what I did: 
1. I navigated to Task-Exercises/Exercise-Files/TASK-8 and ran this command: 
"sudo snort -c /etc/snort/snortv2.conf -A full -l . -r mx-1.pcap"
2. Then I scrolled down to find the number of the generated alerts. 
(View image: Screenshots/Network Security and Traffic Analysis/02/2.8/Screenshot 2025-07-20 at 5.19.09 PM.png)



Q5. Investigate the mx-2.pcap file with the default configuration file.
What is the number of the generated alerts?
A. 340 

* Here is what I did: 
1. I navigated to Task-Exercises/Exercise-Files/TASK-8 and ran this command: 
"sudo snort -c /etc/snort/snort.conf -A full -l . -r mx-2.pcap"
2. Then I scrolled down to find the number of the generated alerts. 
(View image: Screenshots/Network Security and Traffic Analysis/02/2.8/Screenshot 2025-07-20 at 5.22.09 PM.png)


Q6. Keep reading the output. What is the number of the detected TCP packets?
A6. 82

Starting from Q5 terminal, I scrolled a little further down to check the number of the detected TCP packets.
(View image: Screenshots/Network Security and Traffic Analysis/02/2.8/Screenshot 2025-07-20 at 5.25.09 PM.png)


Q7. Investigate the mx-2.pcap and mx-3.pcap files with the default configuration file.
What is the number of the generated alerts?
A7. 1020

* Here is what I did: 
1. I navigated to Task-Exercises/Exercise-Files/TASK-8 and ran this command: 
"sudo snort -c /etc/snort/snort.conf -A full -l . --pcap-list="mx-2.pcap mx-3.pcap""
2. Then I scrolled down to find the number of the generated alerts. 
(View image: Screenshots/Network Security and Traffic Analysis/02/2.8/Screenshot 2025-07-20 at 5.30.26 PM.png)


## From this lab, I learned..   
1. How to run Snort in PCAP investigation mode using different parameters.
Now I know how to analyze both single and multiple .pcap files with Snort using -r, --pcap-list, and --pcap-show. 
These options help in managing large traffic captures and associating alerts with the correct files.
2. Snort leverages rule-based detection even in offline PCAP analysis
Snort still applies the ruleset to offline traffic in PCAP mode, allowing me to identify malicious or suspicious patterns without live capture. This helps speed up forensic investigations.
3. Reading logs beyond alerts gives deeper insights. 
Looking past the alerts, I found useful details like the number of TCP segments queued and HTTP response headers. These metrics help build context around the alert behavior.